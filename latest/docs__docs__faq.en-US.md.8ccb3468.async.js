"use strict";(self.webpackChunkcra_template_doly_site=self.webpackChunkcra_template_doly_site||[]).push([[413],{55281:function(d,o,n){n.r(o);var s=n(22035),c=n(9099),u=n(75799),x=n(6434),p=n(32966),a=n(67779),h=n(72702),m=n(51273),l=n(4434),r=n(80879),i=n(75271),t=n(82505),e=n(52676);function _(){return(0,e.jsx)(l.dY,{children:(0,e.jsx)(i.Suspense,{fallback:(0,e.jsx)(r.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"faq",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#faq",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"FAQ"]}),(0,e.jsxs)("h2",{id:"how-to-jump-pages-in-non-component-modules",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#how-to-jump-pages-in-non-component-modules",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"How to jump pages in non-component modules?"]}),(0,e.jsxs)("p",{children:[t.texts[0].value,(0,e.jsx)("code",{children:t.texts[1].value}),t.texts[2].value]}),(0,e.jsx)(a.Z,{lang:"typescript",children:t.texts[3].value}),(0,e.jsxs)("h2",{id:"error-message-property-encodelocation-is-missing-in-type-hashhistory-but-required-in-type-history",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#error-message-property-encodelocation-is-missing-in-type-hashhistory-but-required-in-type-history",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"error message ",(0,e.jsx)("code",{children:t.texts[4].value})]}),(0,e.jsx)("p",{children:t.texts[5].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{alt:"faq-react-router-dom6.4-error-tip.jpg",src:n(50535)})}),(0,e.jsx)("p",{children:t.texts[6].value}),(0,e.jsx)("p",{children:t.texts[7].value}),(0,e.jsxs)("h2",{id:"how-to-turn-off-the-route-switching-animation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#how-to-turn-off-the-route-switching-animation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"How to turn off the route switching animation?"]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("code",{children:t.texts[8].value}),t.texts[9].value,(0,e.jsx)("code",{children:t.texts[10].value}),t.texts[11].value,(0,e.jsx)("code",{children:t.texts[12].value})]}),(0,e.jsx)(a.Z,{lang:"typescript",children:t.texts[13].value}),(0,e.jsxs)("h2",{id:"load-on-demand-antd4",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#load-on-demand-antd4",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Load on demand ",(0,e.jsx)("code",{children:t.texts[14].value}),"?"]}),(0,e.jsxs)("p",{children:[t.texts[15].value,(0,e.jsx)("code",{children:t.texts[16].value})]}),(0,e.jsx)(a.Z,{lang:"bash",children:t.texts[17].value}),(0,e.jsxs)("p",{children:[t.texts[18].value,(0,e.jsx)("code",{children:t.texts[19].value}),t.texts[20].value]}),(0,e.jsx)(a.Z,{lang:"javascript",children:t.texts[21].value}),(0,e.jsxs)("h2",{id:"how-to-elegantly-implement-login-verification-for-the-pre-login-project",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#how-to-elegantly-implement-login-verification-for-the-pre-login-project",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"How to elegantly implement login verification for the pre-login project?"]}),(0,e.jsxs)("blockquote",{children:[(0,e.jsx)("p",{children:t.texts[22].value}),(0,e.jsxs)("p",{children:[t.texts[23].value,(0,e.jsx)("code",{children:t.texts[24].value}),t.texts[25].value]})]}),(0,e.jsx)("p",{children:t.texts[26].value}),(0,e.jsx)("p",{children:(0,e.jsx)("code",{children:t.texts[27].value})}),(0,e.jsx)(a.Z,{lang:"typescript",children:t.texts[28].value}),(0,e.jsx)("p",{children:t.texts[29].value}),(0,e.jsx)("p",{children:(0,e.jsx)("code",{children:t.texts[30].value})}),(0,e.jsx)(a.Z,{lang:"typescript",children:t.texts[31].value}),(0,e.jsxs)("h2",{id:"package-management-tools-switching-to-pnpm-",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#package-management-tools-switching-to-pnpm-",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Package management tools switching to ",(0,e.jsx)("code",{children:t.texts[32].value})," ?"]}),(0,e.jsxs)("ol",{children:[(0,e.jsxs)("li",{children:[t.texts[33].value,(0,e.jsx)("code",{children:t.texts[34].value}),t.texts[35].value,(0,e.jsx)("code",{children:t.texts[36].value}),t.texts[37].value,(0,e.jsx)("code",{children:t.texts[38].value})]}),(0,e.jsxs)("li",{children:[t.texts[39].value,(0,e.jsx)("code",{children:t.texts[40].value}),t.texts[41].value]}),(0,e.jsxs)("li",{children:[t.texts[42].value,(0,e.jsx)("code",{children:t.texts[43].value}),t.texts[44].value]})]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("code",{children:t.texts[45].value}),t.texts[46].value]}),(0,e.jsx)(a.Z,{lang:"text",children:t.texts[47].value}),(0,e.jsxs)("ol",{start:"4",children:[(0,e.jsxs)("li",{children:[t.texts[48].value,(0,e.jsx)("code",{children:t.texts[49].value}),t.texts[50].value,(0,e.jsx)("code",{children:t.texts[51].value}),t.texts[52].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[53].value}),t.texts[54].value,(0,e.jsx)("code",{children:t.texts[55].value}),t.texts[56].value,(0,e.jsx)("code",{children:t.texts[57].value}),t.texts[58].value,(0,e.jsx)("code",{children:t.texts[59].value})]})]}),(0,e.jsxs)("blockquote",{children:[(0,e.jsx)("p",{children:t.texts[60].value}),(0,e.jsxs)("p",{children:[t.texts[61].value,(0,e.jsx)("code",{children:t.texts[62].value})]})]}),(0,e.jsx)(a.Z,{lang:"bash",children:t.texts[63].value}),(0,e.jsxs)("p",{children:[t.texts[64].value,(0,e.jsx)("code",{children:t.texts[65].value}),t.texts[66].value,(0,e.jsx)("code",{children:t.texts[67].value}),t.texts[68].value,(0,e.jsx)("code",{children:t.texts[69].value}),t.texts[70].value,(0,e.jsx)("code",{children:t.texts[71].value}),t.texts[72].value]}),(0,e.jsxs)("p",{children:[t.texts[73].value,(0,e.jsx)("code",{children:t.texts[74].value}),t.texts[75].value,(0,e.jsx)("code",{children:t.texts[76].value}),t.texts[77].value,(0,e.jsx)("code",{children:t.texts[78].value}),t.texts[79].value]}),(0,e.jsxs)("p",{children:[t.texts[80].value,(0,e.jsx)("code",{children:t.texts[81].value})]}),(0,e.jsx)(a.Z,{lang:"bash",children:t.texts[82].value}),(0,e.jsx)("ol",{start:"6",children:(0,e.jsx)("li",{children:t.texts[83].value})}),(0,e.jsx)(a.Z,{lang:"bash",children:t.texts[84].value})]})})})})}o.default=_},82505:function(d,o,n){n.r(o),n.d(o,{texts:function(){return s}});const s=[{value:"Use directly ",paraId:0,tocIndex:1},{value:"src/router.tsx",paraId:0,tocIndex:1},{value:" :",paraId:0,tocIndex:1},{value:`import router from '@/router';

// util function
function xxx() {
  router.navigate('/list');
}
`,paraId:1,tocIndex:1},{value:"Property 'encodeLocation' is missing in type 'HashHistory' but required in type 'History'.",paraId:2},{value:"If you use a project earlier than react-router-dom@6.4, you may receive the following error after reinstalling dependencies:",paraId:3,tocIndex:2},{value:"This is because the react-router@6.4 version removes the history dependency and adds the RouterProvider.",paraId:4,tocIndex:2},{value:"package.json lock 'react-router-dom@~6.3.0' dependent version.",paraId:5,tocIndex:2},{value:"src/index.tsx",paraId:6,tocIndex:3},{value:" The ",paraId:6,tocIndex:3},{value:"AnimatedRoutes",paraId:6,tocIndex:3},{value:" component settings ",paraId:6,tocIndex:3},{value:"animated={false}",paraId:6,tocIndex:3},{value:`<AnimatedRoutes
  // ...
  animated={false}
/>
`,paraId:7,tocIndex:3},{value:"antd@4",paraId:2},{value:"Install dependencies ",paraId:8,tocIndex:4},{value:"babel-plugin-import",paraId:8,tocIndex:4},{value:`yarn add babel-plugin-import --dev
`,paraId:9,tocIndex:4},{value:"Modify file ",paraId:10,tocIndex:4},{value:"config/config.js",paraId:10,tocIndex:4},{value:" configuration",paraId:10,tocIndex:4},{value:`// ...
babel: {
  plugins: [
    ...whenProd(() => [['transform-remove-console', { exclude: ['error', 'warn'] }]], []),
    ['import', { libraryName: 'antd', libraryDirectory: 'lib', style: true }, 'antd']
  ];
}
`,paraId:11,tocIndex:4},{value:"This scheme is suitable for login and current project which are not in the same project and require complex token conversion.",paraId:12,tocIndex:5},{value:"If it's a simple project, just handle it ",paraId:13,tocIndex:5},{value:"utils/request.ts",paraId:13,tocIndex:5},{value:" in.",paraId:13,tocIndex:5},{value:"If the current project must be logged in before entering, it is recommended to extract a separate Authcomponent for login verification. Such as:",paraId:14,tocIndex:5},{value:"src/components/Auth/index.tsx",paraId:15,tocIndex:5},{value:`import { tokenChange } from '@/services/common';
import { getToken, setToken, getAccessToken, setAccessToken } from '@/utils/tokenStorage';
import { toLoginPage } from '@/utils/utils';

const Auth = ({ children }) => {
  const [logined, setLogined] = React.useState(false);

  React.useEffect(() => {
    const accessToken = getAccessToken();

    if (!accessToken) {
      const loginToken = getToken(); // Third way token

      if (loginToken) {
        // Convert the current project token
        tokenChange().then(res => {
          setAccessToken(res.accessToken);
          setLogined(true);
        });
      } else {
        if (process.env.REACT_APP_ENV === 'dev') {
          // local development
          setToken('252Be844PzHnVqmQ');
          setAccessToken('1zdaf7876546352aflkj');
          setLogined(true);
        } else {
          toLoginPage();
        }
      }
    }
  }, []);

  return <>{logined ? children : null}</>;
};

export default Auth;
`,paraId:16,tocIndex:5},{value:"Put the Auth component in the outermost layer of the project.",paraId:17,tocIndex:5},{value:"src/index.tsx",paraId:18,tocIndex:5},{value:`import Auth from '@/components/Auth';
// ...

function App() {
  // ...
  return <Auth>{/*//...*/}</Auth>;
}
`,paraId:19,tocIndex:5},{value:"pnpm",paraId:2},{value:"Use ",paraId:20,tocIndex:6},{value:"pnpm import",paraId:20,tocIndex:6},{value:" to import the lock dependency version file, and then delete ",paraId:20,tocIndex:6},{value:"package-lock.json",paraId:20,tocIndex:6},{value:" or ",paraId:20,tocIndex:6},{value:"yarn.lock",paraId:20,tocIndex:6},{value:"Delete the ",paraId:20,tocIndex:6},{value:"node_modules",paraId:20,tocIndex:6},{value:" directory",paraId:20,tocIndex:6},{value:"Add the ",paraId:20,tocIndex:6},{value:".npmrc",paraId:20,tocIndex:6},{value:" file to the root of the project, in order to set the dependency flattening",paraId:20,tocIndex:6},{value:".npmrc",paraId:21,tocIndex:6},{value:" file:",paraId:21,tocIndex:6},{value:`shamefully-hoist=true
auto-install-peers=true # If you are using nodejs <= 16, pnpm < 8, you need to enable this option manually.
`,paraId:22,tocIndex:6},{value:"Reinstall the dependencies using ",paraId:23,tocIndex:6},{value:"pnpm install",paraId:23,tocIndex:6},{value:", and then run the script with the ",paraId:23,tocIndex:6},{value:"pnpm",paraId:23,tocIndex:6},{value:" command",paraId:23,tocIndex:6},{value:"git hook",paraId:23,tocIndex:6},{value:" tool tweaks, upgrade ",paraId:23,tocIndex:6},{value:"husky",paraId:23,tocIndex:6},{value:" or change ",paraId:23,tocIndex:6},{value:"yorkie",paraId:23,tocIndex:6},{value:" to ",paraId:23,tocIndex:6},{value:"husky",paraId:23,tocIndex:6},{value:"Since Yorkie and earlier versions of Husky don't support PNPM, an upgrade is required.",paraId:24,tocIndex:6},{value:"Here's an example of yorkie changing to ",paraId:25,tocIndex:6},{value:"husky@8",paraId:25,tocIndex:6},{value:`# Delete yorkie or lower version husky
pnpm remove yorkie

# Delete the .git/hooks directory manually
rm -rf .git/hooks

# Install husky
pnpm dlx husky-init && pnpm install

# Add git hooks
npx husky add .husky/commit-msg 'npx --no -- commitlint --edit "$1"'
`,paraId:26,tocIndex:6},{value:"Switch the ",paraId:27,tocIndex:6},{value:"gitHooks",paraId:27,tocIndex:6},{value:" or ",paraId:27,tocIndex:6},{value:"husky",paraId:27,tocIndex:6},{value:" configuration in ",paraId:27,tocIndex:6},{value:"package.json",paraId:27,tocIndex:6},{value:" to ",paraId:27,tocIndex:6},{value:".husky",paraId:27,tocIndex:6},{value:".",paraId:27,tocIndex:6},{value:"Then remove ",paraId:28,tocIndex:6},{value:"gitHooks",paraId:28,tocIndex:6},{value:" or ",paraId:28,tocIndex:6},{value:"husky",paraId:28,tocIndex:6},{value:" in ",paraId:28,tocIndex:6},{value:"package.json",paraId:28,tocIndex:6},{value:".",paraId:28,tocIndex:6},{value:"For example, ",paraId:29,tocIndex:6},{value:"pre-commit",paraId:29,tocIndex:6},{value:`#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx --no-install lint-staged
`,paraId:30,tocIndex:6},{value:"Whether the running, testing, and building projects are normal",paraId:31,tocIndex:6},{value:`pnpm start
pnpm test
pnpm build
`,paraId:32,tocIndex:6}]},50535:function(d,o,n){d.exports=n.p+"static/faq-react-router-dom6.4-error-tip.3eb49bc8.jpg"}}]);
